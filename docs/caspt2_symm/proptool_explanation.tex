\documentclass[12pt]{article}
\usepackage[utf8x]{inputenc}
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage{color}
\usepackage{wrapfig}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{textcomp}
\usepackage{array}
\usepackage{booktabs}
\usepackage{subfigure}
\usepackage[font=small,format=plain,labelfont=bf,up,textfont=it,up]{caption}
\usepackage{longtable}
\usepackage{calc}
\usepackage{setspace}
\usepackage{multirow}
\usepackage{hhline}
\usepackage{ifthen}
\usepackage{lscape}
\usepackage{relsize}
\usepackage{bbold}
\usepackage{mathtext}
\usepackage{pdfpages}
\usepackage{geometry}
 \geometry{
 a4paper,
 total={170mm,257mm},
 left=35mm,
 top=25mm,
 bottom=25mm,
 right=20mm,
 }
\usepackage{cite}
\linespread{1.3}

\begin{document}
\section {Overview}
\subsection{Purpose}
The program is intended to help with evaluation of the many index expressions which arise in multi-reference pertrbation theory. 
Essentially, it aims to evaluate one of the follwing three kinds of expressions, the simplest of which is
\begin{equation}
\langle M | \hat{X} \hat{Y} ... | N \rangle,
\label{eqn:basic}
\end{equation}
\noindent here $\hat{X}$ and $\hat{Y}$ are some arbitrary operators, and $| N \rangle$  is a multireference wavefunction represented as a linear combination of determinants, $|I\rangle $;
\begin{equation}
|N\rangle = \sum_{I} c_{I}^{N}| I \rangle.
\end{equation} 
\noindent There are three main types of terms the program can calculate. The simplest is :
\begin{equation}
\sum_{\substack{ x_{1}x_{2}...\\ y_{1}y_{2}... \\ ...}} X_{x_{1}x_{2}...} Y_{y_{1}y_{2}...} ...
\sum_{I}\sum_{J}
\langle I | a^{\dagger}_{x_{1}} a_{x_{2}}...a^{\dagger}_{y_{1}}a_{y_{2}}....| J \rangle 
 c^{M \dagger}_{I}c^{N}_{J}
\label{eqn:basic_2nd_quantized}
\end{equation}
\noindent  Which is just (\ref{eqn:basic}) written using second quantization; $X_{x_{1},x_{2}...}$ is a representation of operator
$\hat{X}$ in a basis of molecular orbitals. \\

\noindent It is also possible to calculate derivatives of (\ref{eqn:basic_2nd_quantized})  with respect to ci-coefficients, $c_{I}^{N}$;
 \begin{equation}
\sum_{\substack{ x_{1}x_{2}...\\ y_{1}y_{2}... \\ ...}} X_{x_{1}x_{2}...} Y_{y_{1}y_{2}...} ...
\sum_{J}
\langle I | a^{\dagger}_{x_{1}} a_{x_{2}}...a^{\dagger}_{y_{1}}a_{y_{2}}....| J \rangle 
c^{N}_{J}
\label{eqn:ci_derivative}
\end{equation}
 \noindent In a simlar vein, it is possible to expressions of form:
\begin{equation*}
\sum_{\substack{ x_{1}x_{2}...\\ y_{1}y_{2}... \\ ...}} X_{x_{1}x_{2}...} Y_{y_{1}y_{2}...} ...
\sum_{\Omega}
\sum_{I}\sum_{J}
\langle I | \hat{E}^{\dagger}_{\Omega} a^{\dagger}_{x_{1}} a_{x_{2}}...a^{\dagger}_{y_{1}}a_{y_{2}}....| J \rangle 
 c^{M \dagger}_{I}c^{N}_{J}
\end{equation*}
\begin{equation}
=
\sum_{\substack{ x_{1}x_{2}...\\ y_{1}y_{2}... \\ ...}} X_{x_{1}x_{2}...} Y_{y_{1}y_{2}...} ...
\sum_{I}\sum_{J}
\langle I | a_{\omega_{1}} a_{\omega_{2}}.. .a^{\dagger}_{x_{1}} a_{x_{2}}...a^{\dagger}_{y_{1}}a_{y_{2}}....| J \rangle 
 c^{M \dagger}_{I}c^{N}_{J}
\label{eqn:basic_2nd_quantized_projector}
\end{equation}
 \noindent where the $\hat{E}^{\dagger}_{\Omega}$ is an projection operator which excites electrons from the orbitals used to construct the space in which the
reference wavefunctions, $\{|N\rangle\}$, were originally defined into some virtual space.

\noindent The program is intended to be flexible; and instead of asking for specific perturbation theories or properties, the user
has the option of specifing algebraic expressions directly via the input file.


\subsection{Structural outline}
\noindent The program is split into three main components; an algebraic manipulator, an fci and tensor contraction library, and an task manager (make figure).\\

\noindent The algebraic manipulator should the input expression, and rearranges it into a series of expressions which are more suited to computational evaluation.
To accomplish this it makes extensive use of the commutation relations of the creation and annihilation operators, as well as the physical symmetries of
the operators, in order to minimize the number of terms, and avoid the need for calculation of terms which are likely to be computationally expensive to evaluate (e.g., those 
with large numbers of indexes). This series of expressions is used to form an algebraic task list; a sequence of mathematical operations which need to be evaluated.
It is important to note that the algebraic manipulator is entirely symbolic manipulation, and does not handle any of the large data structures, e.g., civectors,
matrices of molecular orbital indices used. The expressions in the algebraic task list do not in any way specify what kind of data structures need to be used to store the
quantities necessary for their evaluation.\\

\noindent The FCI and tensor libraries contains generic routines for calculating density matrices and their derivatives, and performing tensor contractions (and other 
various tensor manipulations). The tensor and FCI library are completely disctinct from the algebraic manipulator, and operate totally independently. The FCI library is designed
such that it can calculate density matrices (and derivatives) or arbitrary order. In a similar vein, the tensor library can operate on tensor of arbitrary rank, with each dimension 
being an arbitrary and different size. At present both the FCI uses the dvec and determinant classes defined in bagel, but this should be phased out. Similarly, the tensor 
contraction makes use of the SMITH::Tensor\_ class. \\

\noindent The final component of the program is the task manager which is intended to faciliate communication between the routines. This is necessary, as the neither the arithmetic component 
has now knowledge of the classes used in the algebraic manipulator, and vice versa. Whilst this has complicated the design slightly, it should enable greater portability, as well
as making the program substantially easier to extend and upgrade.
\\ 
\noindent In a sense there is a fourth component, a driving routine, which performs some communication between the three routines, and which deals with interpretation of the input. However,
whilst this component is practically important, and not particularly small, it is rather simple, and not of interest, so I will not discuss it significantly.

\section{ Specific components}
 

\end{document}
